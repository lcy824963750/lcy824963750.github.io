---
layout: post
title: '《深入Java虚拟机》学习笔记(二)'
date: '2015-11-13'
header-img: "img/post-bg-web.jpg"
tags:
     - JVM
author: 'lcy'
---
### Java的平台无关性

#### 一、Java的体系结构对于平台无关性的支持
&emsp;&emsp;1.Java平台
&emsp;&emsp;Java平台扮演一个运行时Java程序和其下的硬件与操作系统之间的缓冲角色，无论Java程序被部署到什么地方，它只需要与Java平台交互，而不需要关心底层的硬件和操作系统。
&emsp;&emsp;2.Java程序设计语言
&emsp;&emsp;Java保证了基本数据类型在所有的平台上都是一致的，不像C++等，在不同的平台上可能不一致。Java语言为Java程序的平台无关性提供了强有力的支持。
&emsp;&emsp;3.Java class文件
&emsp;&emsp;Java class文件可以在任何平台上创建，也可以被任何平台的虚拟机装入并且运行，它的格式等有着严格的规定，并且与JVM所在的平台是无关的。
&emsp;&emsp;4.可伸缩性
&emsp;&emsp;Java可以在各种各样不同类型的计算机上实现。Sun公司定义的三个基础API集合，表现了Java平台不同的伸缩性。

* 企业版（J2EE）
* 标准版（J2SE）
* 微型版（J2ME）

#### 二、影响平台无关性的因素
&emsp;&emsp;1.Java平台的部署
&emsp;&emsp;只有在拥有Java平台的计算机上，才能够运行Java程序。因为决定Java程序平台无关性的一个重要因素就是已有了可用的Java平台和发布版本。
&emsp;&emsp;2.Java平台的版本
&emsp;&emsp;Java API是在不断地更新的，它只能保证向上兼容，但是不能保证向下兼容，所以使用新版本API开发的Java程序并不一定能够在装有老API的计算机上运行。所以当发布一个新的Java平台版本时，我们必须确认针对这个新的版本来编写程序是否合适。
&emsp;&emsp;3.本地方法
&emsp;&emsp;要想实现平台无关性，最好的方法就是杜绝使用本地方法，仅通过Java API来与主机进行交互。
&emsp;&emsp;4.非标准运行时库
&emsp;&emsp;Java平台可以由许多的开发商来实现，个别开发商可能提供了非标准运行时库之外的库，这时候就必须确认这些非标准库是否调用了本地方法，如果调用了，同样会影响Java程序的平台无关性。
&emsp;&emsp;5.对虚拟机的依赖
&emsp;&emsp;Java虚拟机的某些部分是由不同开发商采取不同的方法来实现的，所以我们必须要坚持两个原则：

* 不要依赖及时终结来确保程序的正确性。(GC)
* 不要依赖线程优先级来确保程序的正确性。

&emsp;&emsp;6.对用户界面的依赖
&emsp;&emsp;7.Java平台实现中的bug
&emsp;&emsp;可能Java平台的某些实现发布时仍然存在bug，我们只能通过测试来确保这个bug是否影响了你的程序，如果影响了，只能想办法绕开。
&emsp;&emsp;8.测试
&emsp;&emsp;在程序可能运行的不同主机和平台上测试写的Java程序，是平台无关性的一个关键因素。

#### 三、平台无关性的七个步骤
1. 选择程序要运行的主机和设备的集合。
2. 在目标宿主机上选择自认为足够好的Java平台版本，在该版本的Java平台上编写、运行程序。
3. 对于每个目标宿主机，搭建好Java平台。(根据你的程序将要运行的平台)
4. 编写程序，使得它只通过Java API的标准运行库来访问计算机。
5. 编写程序，使它不依赖于GC及时终结的正确性，不依赖于线程的优先级。
6. 努力设计一个用户界面，使得它在你的所有目标宿主机上都能正常工作。
7. 在所有的目标运行时环境和目标主机上测试你的程序。

> 如有任何知识产权、版权问题或理论错误，还请指正。
>
> 转载请注明原作者及以上信息。
