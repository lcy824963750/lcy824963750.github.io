---
layout: post
title: '《深入Java虚拟机》学习笔记(三)'
date: '2015-11-16'
header-img: "img/post-bg-web.jpg"
tags:
     - JVM
author: 'lcy'
---

### 安全性
&emsp;&emsp;Java的安全模型侧重于保护终端用户免受从网络上下载的、来自不可靠来源的、恶意程序的侵犯。Java提供了沙箱来达到这个目的。

#### 一、基本沙箱
&emsp;&emsp;组成Java沙箱的基本组件
&emsp;&emsp;1.类装载器结构
&emsp;&emsp;2.class文件校验器
&emsp;&emsp;3.内置于JVM的安全特性
&emsp;&emsp;4.安全管理器及Java API

#### 二、类装载器结构
&emsp;&emsp;类装载器体系结构在三个方面对Java的沙箱起作用：
&emsp;&emsp;1.防止恶意的代码去干涉善意的代码
&emsp;&emsp;2.它守护了被信任的类库的边界
&emsp;&emsp;3.它将代码归于某类，该类确认了代码可以进行哪些操作。

&emsp;&emsp;双亲委派模式的实现
&emsp;&emsp;在了解什么是双亲委派模式之前，必须知道什么是启动类装载器，启动类装载器就是只负责装载那些核心Java API的装载器。在新的Java版本中，应用程序启动之前，它至少创建一个用户自定义类装载器，所有这些类装载器被连接在一个双亲-孩子关系链中，位于这个链顶端的就是启动类装载器，在一个类装载器得到要装载一个类的请求时，会首先询问他的双亲，看它的双亲能否加载，如果它的双亲不能加载，会尝试自己来进行加载，以此类推。
&emsp;&emsp;例子:假设现在存在这么一条双亲孩子链，顶端是启动类装载器，下面依次是标准扩展类装载器、类路径类装载器、网络类装载器。假设现在需要装载一个名叫java.lang.Virus的类，网络类装载器会询问他的双亲类路径装载器，类路径装载器会询问它的双亲标准扩展类装载器，标准扩展类装载器会询问启动类装载器，启动类装载器发现没有找到这个类，于是标准扩展类装载器来尝试寻找，以此类推，一直到类路径装载器都没有找到，于是网络类装载器会从网络上下载这个类。

&emsp;&emsp;问题：假设现在装载了java.lang.Virus这个类，暗示它是Java核心API的一部分，可想而知，他将得到访问java.lang包下的类的权限，从而达到不可告人的目的。类装载器机制防止了这个问题，它引入了一个叫做运行时包的概念，只有在同一运行时包下的类才能够互相访问，所谓的运行时包就是指被同一类装载器装载、属于同一个包的、多个类型的集合。

#### 三、class文件校验器
&emsp;&emsp;1.class文件的结构检查：确认待检查的字节序列遵从Java class文件的固定格式。
&emsp;&emsp;2.类型数据的语义检查
&emsp;&emsp;3.字节码验证
&emsp;&emsp;4.符号引用的验证

#### 三、Java虚拟机中内置的安全特性
&emsp;&emsp;JVM在执行字节码时会进行如下的检查：
&emsp;&emsp;1.类型安全的引用转换
&emsp;&emsp;2.结构化的内存访问（无指针算法）
&emsp;&emsp;3.GC
&emsp;&emsp;4.数组边界检查
&emsp;&emsp;5.空指针

#### 四、安全管理器和Java API
&emsp;&emsp;可以在程序中显示的声明一个安全管理器，以此来对某些不安全的操作进行限制。

 
> 如有任何知识产权、版权问题或理论错误，还请指正。
>
> 转载请注明原作者及以上信息。
